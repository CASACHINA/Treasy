
select  COUNT(*) FROM
(
SELECT CAST(SUBSTRING( CT2_DATA , 5, 2) as INTEGER) as MES, SUBSTRING( CT2_DATA , 1, 4) AS ANO ,SM0.FILFULL AS COD_FIL,SM0.FILIAL AS DESC_FIL, 
'GERAL' AS CC_DESC, CT2_DEBITO, CT1_DESC01
, SUM(CT2_VALOR) AS VALOR
FROM SM0010 SM0
INNER JOIN CT2010 CT2 ON CT2_FILIAL = SM0.FILFULL
INNER JOIN CT1010 CT1 ON CT1.CT1_CONTA = CT2.CT2_DEBITO

	WHERE   CT1.D_E_L_E_T_ = ' ' AND CT2.D_E_L_E_T_ = ' '
		and CT2_DEBITO IN ('570300300001',
'570300300002',
'570300300006',
'570300300007',
'570300300008',
'570300500002',
'570300500003',
'570300500007',
'570300500008',
'570300700001',
'570300700002',
'570300700003',
'570300700004',
'570300700005',
'570300700006',
'570300900001',
'570301100001',
'570301100002',
'570301100003',
'570301100004',
'570301100005',
'570301100006',
'570301100008',
'570301100010',
'570301100011',
'570301300001',
'570301300003',
'570301300004',
'570301300007',
'570301500001',
'570301500002',
'570301500003',
'570301500005',
'570301500006',
'570301500007',
'570301500009',
'570301500010',
'570301500011',
'570301500013',
'570301500014',
'570301500015',
'570301500016',
'570301500019',
'570301500020',
'570301500021',
'570301500022',
'570301500024',
'570301500025',
'570301500027',
'570301500032',
'570301500035',
'570301500039',
'570301500040',
'570301500041',
'570301500042',
'570301500043',
'570301500045',
'570301500047',
'570301500048',
'570301500049',
'570301500050',
'570301500051',
'570301500052',
'570301500053',
'570301500054',
'570301500055',
'570301500056',
'570301500057',
'570301500058',
'570301500059',
'570301700001',
'570301700002',
'570301700003',
'570301700004',
'570301700005',
'570900100002',
'570900100003',
'570900100004',
'570900100005',
'570900100008',
'570900100014',
'570900100020',
'570900100021',
'580100100001',
'580100100002',
'580100100003',
'580100100006',
'580100100007',
'580100100008',
'580100100999',
'580200100001',
'580200100002',
'580200100003',
'580200100004',
'580200100005',
'580200100006',
'580200100007',
'580200100008',
'580200100009',
'580200100010',
'580200100011',
'580200100012',
'580200100013',
'580200100014',
'590100100002',
'590100100003',
'590100100004',
'590100100005',
'590100100006',
'590100100007',
'590100100008',
'590100100009',
'590100100099',
'590100200002',
'590100200099',
'590100300002',
'590100300003')
	AND CT2_DATA >=  ${DATA_INICIAL} AND CT2_DATA <=  ${DATA_FINAL} 
	--AND CT2.CT2_DATA BETWEEN '20220101' AND '20220131' and CT2_FILIAL='010102'

GROUP BY SUBSTRING( CT2_DATA , 5, 2), SUBSTRING( CT2_DATA , 1, 4) ,SM0.FILFULL ,SM0.FILIAL,CT2_CCD,
CT2_DEBITO,CT1_DESC01
) AS TMP
;